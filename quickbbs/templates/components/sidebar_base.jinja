{#
  Sidebar Base Template

  Base template for all sidebar variations with shared CSS and structure.
  Child templates implement specific blocks for their navigation needs.

  Sidebar Order:
  1. Navigation Up
  2. First Page Button
  3. Previous Page Button
  4. Page Selector
  5. Next Page Button
  6. Next Page (New Tab) - Item view only
  7. Last Page Button
  8. Sort Options
  9. Download Button - Item view only
#}

<!-- Optimized Django Sidebar Template -->
<aside class="sidebar is-narrow" id="sidebar">
  <div class="sidebar-content">

    <!-- Navigation Up -->
    <div class="sidebar-section">
      {% block nav_up_button %}{% endblock %}
    </div>

    <!-- Custom Info Section (for search results, etc.) -->
    {% block custom_info_section %}{% endblock %}

    <!-- First Page + Previous Page -->
    <div class="sidebar-section">
      {% block first_page_button %}{% endblock %}
      {% block previous_page_button %}{% endblock %}
    </div>

    <!-- Page Selector -->
    <div class="sidebar-section">
      {% block page_selector %}{% endblock %}
    </div>

    <!-- Next Page + Next Page (New Tab) + Last Page -->
    <div class="sidebar-section">
      {% block next_page_button %}{% endblock %}
      {% block next_page_new_tab %}{% endblock %}
      {% block last_page_button %}{% endblock %}
    </div>

    <!-- Sort Options -->
    <div class="sidebar-section">
      {% block sort_options %}
      <div class="field">
        <label class="label is-small has-text-centered">Sort</label>
        <form action="?" method="GET" class="sort-form">
          <input type="hidden" name="page" value="{{current_page}}">
          <div class="select is-small is-fullwidth">
            <select name="sort"
                    hx-get=""
                    hx-target="body"
                    hx-swap="innerHTML show:window:top transition:true"
                    hx-push-url="true"
                    hx-sync="body:abort"
                    hx-trigger="change"
                    hx-include="[name='page']">
              <option value="0" {% if sort == 0 %}selected{% endif %}>A..Z</option>
              <option value="1" {% if sort == 1 %}selected{% endif %}>Last Modified</option>
              <option value="2" {% if sort == 2 %}selected{% endif %}>Created</option>
            </select>
          </div>
        </form>
      </div>
      {% endblock %}
    </div>

    <!-- Download Button (Item view only) -->
    {% block download_button %}{% endblock %}
    
    <!-- Version Display -->
    <div class="sidebar-section version-section">
      <div class="version-display">
        <span class="label is-small has-text-centered">Version</span>
        <p class="has-text-centered version-number">{{ app_version }}</p>
      </div>
    </div>


  </div>
</aside>

<style>
/* Custom CSS for the sidebar */
.sidebar {
  position: fixed;
  left: 0;
  top: 98px;
  height: 100vh;
  width: 7.5%;
  background: hsl(0, 0%, 98%);
  border-right: 1px solid hsl(0, 0%, 86%);
  z-index: 30;
  overflow-y: auto;
}

/* Image container positioning to avoid sidebar overlap */
.filetype-main-container {
  margin-left: 7.5%;
  margin-right: 1rem;
}

.sidebar-content {
  padding: 0.5rem 0.25rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.sidebar-section {
  padding: 0.25rem 0;
}

.sidebar-section:not(:last-child) {
  border-bottom: 1px solid hsl(0, 0%, 86%);
  padding-bottom: 0.5rem;
  margin-bottom: 0.5rem;
}

/* Button spacing within sections */
.sidebar-section .button.is-ghost:not(:last-child) {
  margin-bottom: 0.5rem;
}

.button.is-ghost {
  border: 1px solid transparent;
  padding: 0.75rem;
  height: auto;
  min-height: 3.5rem;
}

.button.is-ghost:hover {
  background-color: hsl(0, 0%, 96%);
  border-color: hsl(0, 0%, 86%);
}

.button.is-ghost.is-disabled {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

.field {
  margin-bottom: 0.5rem;
}

.label {
  font-size: 0.75rem;
  margin-bottom: 0.25rem;
  text-align: center;
}

.help {
  font-size: 0.65rem;
  text-align: center;
  margin-top: 0.25rem;
}

.select.is-small select {
  font-size: 0.75rem;
  height: 2rem;
}

/* Version display styling */
.version-section {
  margin-top: 1rem;
}

.version-display {
  text-align: center;
  padding: 0.5rem 0;
}

.version-number {
  font-size: 0.75rem;
  font-weight: 500;
  color: hsl(0, 0%, 48%);
  margin-top: 0.25rem;
}

/* Page selector styling */
.page-selector {
  display: flex;
  align-items: center;
  justify-content: center;
}

.page-selector .field {
  margin-bottom: 0;
  width: 100%;
}

.page-selector .label {
  font-size: 0.65rem;
  margin-bottom: 0.25rem;
}

.page-selector .select {
  margin: 0;
}

.page-selector select {
  min-width: 4rem;
  text-align: center;
  font-weight: 600;
}

.page-selector .help {
  font-size: 0.65rem;
  margin-top: 0.25rem;
}

/* Static page display (for item view) */
.page-display {
  text-align: center;
  font-weight: 600;
  font-size: 1rem;
  padding: 0.25rem 0;
}

/* Mobile responsiveness */
@media screen and (max-width: 768px) {
  .sidebar {
    width: 60px;
  }

  .filetype-main-container {
    margin-left: 60px;
    margin-right: 0.5rem;
  }

  .sidebar-content {
    padding: 0.25rem 0.125rem;
  }

  .label,
  .help {
    display: none;
  }

  .field {
    margin-bottom: 0.25rem;
  }

  .button.is-ghost {
    padding: 0.5rem;
    min-height: 3rem;
  }

  /* Mobile: Hide version label but keep number */
  .version-display .label {
    display: none;
  }

  .version-number {
    font-size: 0.65rem;
  }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  .sidebar {
    background: hsl(0, 0%, 14%);
    border-right-color: hsl(0, 0%, 29%);
  }

  .sidebar-section:not(:last-child) {
    border-bottom-color: hsl(0, 0%, 29%);
  }
}
</style>
